<section id="area_cartao">
    <div class="conteiner_cartao" style="overflow: hidden !important;">

        <h2>CARTÃO DE CREDITO</h2>

        <form action="home" method="post" class="form"  id="formCartao" onsubmit="finalizarCompra(event)">

            <input type="text" name="numero" placeholder="Número do Cartão" required maxlength="16" inputmode="numeric">
            <input type="text" name="nome" placeholder="Nome Completo" required>
            <div class="validacao">
                <input type="month" name="validade" id="termos" required placeholder="Data de Validade">
                <input type="text" name="segurança" placeholder="Código de Segurança" maxlength="3" inputmode="numeric">
            </div>
            <input type="text" name="cpf" placeholder="CPF" required maxlength="11" inputmode="numeric">
            <div class="btn_login">
                <a id="link" href="index.php">Voltar</a>
                <button id="link" type="submit">Confirmar</button>
            </div>
        </form>
    </div>
</section>






<script>
// Função para finalizar a compra e adicionar o item ao pedido
function finalizarCompra(event) {
    event.preventDefault();

    // Recuperando o ID do produto armazenado no localStorage
    const produtoId = localStorage.getItem('produtoId');

    // Criar o objeto com o ID do pedido e o ID do produto
    const itemPedidoData = {
        item_id: produtoId,
    };

    // Enviar os dados para o backend (POST para adicionar o item ao pedido)
    fetch('http://localhost:8080/api/ItemPedido', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(itemPedidoData)
    })
    .then(response => response.json())
    .then(data => {
        console.log("Item adicionado ao pedido com sucesso:", data);
        // Mostrar alerta de sucesso
        alert("Compra finalizada com sucesso!");
        // Redireciona para a página de confirmação ou sucesso
        window.location.href = "home";  // Página de sucesso
    })
    .catch(error => {
        console.error("Erro ao adicionar item ao pedido:", error);
        // Mostrar alerta de erro
        alert("Ocorreu um erro ao finalizar a compra. Tente novamente.");
    });
}
</script>

